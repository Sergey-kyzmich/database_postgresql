# DATABASE
<h2>Это шпаргалка для использования модуля database с для postgresql. Создание конфига для подключения и инструкция в config.py</h2>

## Типы данных и их запись
### serial (psql: serial)
    Тип данных serial в автоматическом порядке записывает в столбец корректный порядковый номер записи(используется для создания колонки id) при указании значения DEFAULT. 
    Для дополнительной информации см "Нюансы при использовании дб".

### integer (psql: integer)
    Записывается как обычное числовое значение. 
    Пример: data = 1
### string (psql: text)
    Записывается как обычное числовое значение
    Пример: data = "text"
### boolean (psql: boolean)
    Передается как обычное булевое значение
    Пример: data = True
### dict in list (psql: jsonb)
    Массив json записей. Передается в виде массива(list), в котором перечислены json(dict) элементы.
    Пример: data=[{"key1": 1, "key2": "2"}, {"key3": "22:00+00:00"}]
### time with time zone (psql: timetz)
    время + временая зона.
    Передается в формате "hours:minutes+tz_hours:tz_minutes" в виде строки.
    Пример: data = "11:00+03:00"
### datetime with time zone (psql: timestamptz)
    дата + время + временая зона.
    Передается в формате "years-mouth-day hours:minutes+tz_hours:tz_minutes" в виде строки.
    Пример: data = "2024-01-01 14:30+03:00"

## Нюансы при использовании дб
### id:
    Если столбец - id и требуется указать порядковый номер(psql: serial) записи, то следует передать None
    Пример: id = None
    Если для id требуется передать целое число, то указать его как integer (psql: integer)
### dict in list
    при создании массива из dict переменных, не стоит передавать в json такие типы данных, как: bool, dict, list.
    datetime и time следует передавать в виде строки.


# Функции и Классы

## class database
<h3>"""класс database содержит все нижеперечисленные функции.\n
На вход принимает:\n
*active_log* str | None=None - активирует сохранение действий ("all"-всех, "main"-только основных(error/connect/close_connect), None - отключает данную функцию) в бд в таблицу(log). Не является обязательным аргументом\n
*test_mode* bool|None=None - значение True активирует вывод всех действий в консоль. Не является обязательным аргументом\n</h3>

## ВАЖНО!
    Все функции являются асинхронными.
    
    Обязательно к изучению -> config.py

    Все функции, которые перечислены ниже, возвращают класс с 2-мя значениями value и error. Если при выполнении кода ошибок небыло, то значение error=None, иначе error содержит информацию о ошибке; value=None
## connect (class: database)
<h3>Подключение к базе данных(Возвращает True, если функция успешно завершена, иначе текст ошибки)<br><br>
Данных на вход не требуется.</h3>

## close_connect (class: database)
<h3>Закрытие подключения к базе данных. <br><br>
(Возвращает True, если функция успешно завершена, иначе текст ошибки)<br><br> 
Данные на вход не требуются.</h3>

## create_table (class: database)
<h3>Создание таблиц, если не созданы ранее.<br><br>
(Возвращает True, если функция успешно завершена, иначе текст ошибки)<br><br> 
Данные на вход не требуются.</h3>

## execute (class: database)
<h3>Используется, если требуется выполнить не стандартный запрос<br><br>
Возвращает <em>cursor</em><br>
На вход принимает:
<em>execute</em> str - текст запроса для postgesql таблицы </h3>

## get_column (class: database)
<h3> Возвращает столбец(class с ключами value(если ответ был получен), либо error(если запрос вернул ошибку))<br><br>
На вход принимает: <br><br>
<em>column</em> str - имя столбца, записи которого требуется получить(Так-же может принимать массив столбцов) <br><br>
<em>table</em> str - имя таблици, записи из которой требуется получить<br><br>
<em>arg</em> str | None=None - дополнение к запросу, если требуется получить выборку из ответа. Не является обязательным аргументом</h3>

## get_all (class: database)
<h3>Возвращает всю таблицу.(class с ключами value(если ответ был получен), либо error(если запрос вернул ошибку)) <br><br>
На вход принимает: <br><br>
<em>table</em> str - имя таблицы, которую требуется получить </h3>

## get (class: database)
<h3>Возвращает данные о записи.(class с ключами value(если ответ был получен), либо error(если запрос вернул ошибку)) <br><br>
        На вход принимает: <br><br>
        <em>id</em> int | str - идентификатор записи <br><br>
        <em>key</em> str - имя столбца, по которому ведется поиск <br><br>
        <em>table</em> str - имя таблицы, из которой требуется получить запись<br><br>
        <em>arg</em> str | None=None - дополнение к запросу, если требуется получить выборку из ответа. Не является обязательным аргументом</h3>

## create (class: database)
<h3>Создает запись в таблице.<br><br>
(Возвращает True, если функция успешно завершена, иначе текст ошибки)<br><br>
На вход принимает:<br><br>
<em>data</em> dict - словарь, где перечислены данные для заполнения и в качестве ключей указаны названия столбцов<br><br>
<em>table</em> str - имя таблици, запись в которой требуется сделать<br><br>
<em>arg</em> str | None=None - дополнение к запросу, если требуется получить выборку из ответа. Не является обязательным аргументом<br><br>
<em>type_data</em> list | None=None - массив, в котором описывается тип входных данных(в формате строки)(каждый id в массиве соответствует порядковому номеру ячейки в data). 
Не является обязательным аргументом. Допустимые типы: ("integer" - integer, "string" - string, "boolean" - boolean, "timetz" - time with time zone, "timestamptz" - datetime with time zone, "jsonb" - массив с ячейками json)</h3>

## update (class: database)
<h3>Обновляет запись в таблице.<br><br>
(Возвращает True, если функция успешно завершена, иначе текст ошибки)<br><br>
На вход принимает:<br><br>
<em>id<em> int | str - идентификатор записи <br><br>
<em>key<em> str - имя столбца, по которому ведется поиск <br><br>
<em>data<em> dict - словарь, где перечислены данные для обновления и в качестве ключей указаны названия столбцов<br><br>
<em>table<em> str - имя таблици, в которой требуется обновить запись<br><br>
<em>arg<em> str - дополнение к запросу, если требуется получить выборку из ответа. Не является обязательным аргументом<br><br>
<em>type_data<em> list - массив, в котором описывается тип входных данных(в формате строки)(каждый id в массиве соответствует порядковому номеру ячейки в data). 
Не является обязательным аргументом. допустимые типы: ("integer" - integer, "string" - string, "boolean" - boolean, "timetz" - time with time zone, "timestamptz" - datetime with time zone, "jsonb" - массив с ячейками json)</h3>

## delete (class: database)
<h3>Удаляет запись из таблицы(если надо удалить одно из значений, используйте update). <br><br>
(Возвращает True, если функция успешно завершена, иначе текст ошибки)<br><br>
На вход принимает: <br><br>
<em>id<em> int | str - идентификатор записи <br><br>
<em>key<em> str - имя столбца, по которому ведется поиск <br><br>
<em>table<em> str - имя таблицы, из которой удаляется запись<br><br>
<em>arg<em> str - дополнение к запросу, если требуется получить выборку из ответа. Не является обязательным аргументом</h3>

## len (class: database)
<h3>Возвращает кол-во записей в таблице.(class с ключами value(если ответ был получен), либо error(если запрос вернул ошибку)) <br><br>
На вход принимает: <br><br>
<em>table</em> str - имя таблицы, длину которой требуется получить.
<em>arg</em> str - дополнение к запросу, если требуется получить выборку из ответа. Не является обязательным аргументом</h3>

## add_log (class: database)
<h3>Создает запись в таблице log.
Если при инициализации класса не был передан active_log(или было передано None), до запись проводиться не будет.
(Возвращает True, если функция успешно завершена, иначе текст ошибки)<br><br>
Данные на вход:
text str - текст записи, которую требуется сделать<br><br>
type str - тип записи(ERROR/INFO)</h3>